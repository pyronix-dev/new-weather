module.exports=[72387,a=>{"use strict";var b=a.i(16552),c=a.i(8284),d=a.i(63090),e=a.i(70230),f=a.i(59389),g=a.i(80630),h=a.i(39700),i=a.i(17553);let j=()=>(0,b.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})});function k({isOpen:a,onClose:e,user:f}){let g=(0,d.useRouter)(),{showToast:k}=(0,h.useToast)(),[l,m]=(0,c.useState)(!1),[n,o]=(0,c.useState)({full_name:f?.full_name||"",email:f?.email||"",phone:f?.phone||""}),p=async a=>{a.preventDefault(),m(!0);try{if(!(await fetch("/api/user/profile",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)throw Error("Failed to update");g.refresh(),e(),k("Profil mis Ã  jour avec succÃ¨s !","success")}catch(a){k("Erreur lors de la mise Ã  jour.","error")}finally{m(!1)}};return(0,b.jsx)(i.Root,{open:a,onOpenChange:e,children:(0,b.jsxs)(i.Portal,{children:[(0,b.jsx)(i.Overlay,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 animate-fade-in"}),(0,b.jsxs)(i.Content,{className:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white rounded-2xl shadow-2xl p-6 z-50 animate-scale-in focus:outline-none",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,b.jsx)(i.Title,{className:"text-xl font-black text-slate-800",children:"Modifier mon profil"}),(0,b.jsx)(i.Close,{className:"p-2 rounded-full hover:bg-slate-100 text-slate-500 transition-colors",children:(0,b.jsx)(j,{})})]}),(0,b.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Nom complet"}),(0,b.jsx)("input",{type:"text",value:n.full_name,onChange:a=>o({...n,full_name:a.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-800 focus:border-transparent transition-all",placeholder:"Jean Dupont"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"Email"}),(0,b.jsx)("input",{type:"email",value:n.email,onChange:a=>o({...n,email:a.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-800 focus:border-transparent transition-all",placeholder:"jean@exemple.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-bold text-slate-700 mb-1",children:"TÃ©lÃ©phone"}),(0,b.jsx)("input",{type:"tel",value:n.phone,onChange:a=>o({...n,phone:a.target.value}),className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 focus:outline-none focus:ring-2 focus:ring-slate-800 focus:border-transparent transition-all",placeholder:"+596 696 XX XX XX"})]}),(0,b.jsxs)("div",{className:"pt-4 flex gap-3",children:[(0,b.jsx)("button",{type:"button",onClick:e,className:"flex-1 py-3 font-bold text-slate-600 bg-slate-100 hover:bg-slate-200 rounded-xl transition-colors",children:"Annuler"}),(0,b.jsx)("button",{type:"submit",disabled:l,className:"flex-1 py-3 font-bold text-white bg-slate-800 hover:bg-slate-900 rounded-xl transition-colors disabled:opacity-50",children:l?"Enregistrement...":"Enregistrer"})]})]})]})]})})}var l=a.i(28941);let m=(0,l.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),n=(0,l.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),o=(0,l.default)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),p=(0,l.default)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),q=(0,l.default)("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),r=(0,l.default)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),s=(0,l.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function t({initialUser:a}){let{showToast:i}=(0,h.useToast)(),[j,l]=(0,c.useState)(a?{reference:a.reference||a.name,full_name:a.name,email:a.email,phone:a.phone||null,notifications_enabled:a.notifications_enabled??!0,role:a.role,subscription:a.subscription}:null),[t,u]=(0,c.useState)(!a),[v,w]=(0,c.useState)(!!a&&!a.subscription),[x,y]=(0,c.useState)(!0),[z,A]=(0,c.useState)(!1),B=(0,d.useRouter)();(0,c.useEffect)(()=>{(async()=>{try{let b=await fetch("/api/auth/me");if(!b.ok){a||B.push("/login");return}let c=await b.json();l(a=>a?{...a,...c,subscription:c.subscription||a.subscription}:c)}catch(a){console.error("Failed to fetch user data:",a)}finally{u(!1),w(!1),y(!1)}})()},[B]);let C=async()=>{await fetch("/api/auth/logout",{method:"POST"}),B.push("/login")};if(t)return(0,b.jsx)("div",{className:"min-h-screen bg-stone-100 flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-slate-600 font-medium",children:"Chargement..."})});if(!j)return null;let D="Utilisateur";j.full_name?D=j.full_name.split(" ")[0]:j.email&&(D=j.email.split("@")[0]);let E={name:D,email:j.email||"",role:j.role},F=j.email||j.phone||"Non dÃ©fini",G="Email",H=!1;j.subscription?j.subscription.plan.toLowerCase().includes("sms")?(F=j.phone||F,G="NumÃ©ro vÃ©rifiÃ©",H=!0):j.subscription.plan.toLowerCase().includes("email")&&(F=j.email||F,G="Email"):j.email?(F=j.email,G="Email"):j.phone&&(F=j.phone,G="TÃ©lÃ©phone");let I=new URLSearchParams;return j.email&&I.set("email",j.email),j.phone&&I.set("phone",j.phone),j.reference&&I.set("ref",j.reference),(0,b.jsxs)("div",{className:"min-h-screen bg-stone-100",children:[(0,b.jsx)(f.Header,{initialUser:E}),(0,b.jsxs)("main",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"text-2xl sm:text-3xl font-black text-slate-800 flex items-center gap-2",children:[(0,b.jsx)("span",{children:"Bonjour,"}),x&&(!j.full_name||j.email&&j.full_name===j.email.split("@")[0])?(0,b.jsx)("div",{className:"h-8 w-32 bg-slate-200 rounded-lg animate-pulse"}):(0,b.jsxs)("span",{children:[D," ðŸ‘‹"]})]}),(0,b.jsx)("p",{className:"text-slate-500 font-medium",children:"GÃ©rez votre abonnement et vos alertes"})]}),(0,b.jsxs)("button",{onClick:C,className:"flex items-center gap-2 px-4 py-2 bg-white border border-slate-200 hover:bg-slate-50 text-slate-700 font-bold rounded-xl transition-colors text-sm w-fit shadow-sm",children:[(0,b.jsx)(p,{className:"w-5 h-5"}),"Se dÃ©connecter"]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:j.subscription?(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[(0,b.jsxs)("h2",{className:"font-black text-slate-800 flex items-center gap-2",children:[(0,b.jsx)(q,{className:"w-6 h-6 text-emerald-500"}),"Abonnement Actif"]}),(0,b.jsx)("span",{className:"px-3 py-1 bg-emerald-100 text-emerald-700 text-xs font-bold rounded-full uppercase tracking-wide",children:j.subscription.status})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-slate-800 mb-1",children:j.subscription.plan}),(0,b.jsxs)("p",{className:"text-slate-500 text-sm",children:["Renouvellement le ",j.subscription.nextBilling]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)("span",{className:"block text-2xl font-black text-slate-800",children:j.subscription.price}),(0,b.jsx)("span",{className:"text-xs text-slate-500 font-medium",children:j.subscription.plan.includes("Mensuel")?"/ mois":"/ an"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-6 border-t border-slate-100",children:[(0,b.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,b.jsx)("p",{className:"text-xs text-slate-500 font-bold uppercase mb-1",children:"RÃ©fÃ©rence"}),(0,b.jsx)("p",{className:"font-mono font-bold text-slate-700 text-lg",children:j.reference})]}),(0,b.jsxs)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100",children:[(0,b.jsx)("p",{className:"text-xs text-slate-500 font-bold uppercase mb-1",children:G}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-slate-700 font-medium",children:[F,H&&(0,b.jsx)(s,{className:"w-4 h-4 text-emerald-500"})]})]})]})]}),(0,b.jsxs)("div",{className:"px-6 py-4 bg-slate-50 border-t border-slate-100 flex gap-4",children:[(0,b.jsx)(e.default,{href:`/alertes?${I.toString()}`,className:"text-sm font-bold text-slate-600 hover:text-slate-900 transition-colors",children:"Changer de plan"}),(0,b.jsx)(e.default,{href:"/dashboard/cancel",className:"text-sm font-bold text-red-600 hover:text-red-700 transition-colors ml-auto",children:"Annuler l'abonnement"})]})]}):t||v?(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden animate-pulse",children:[(0,b.jsxs)("div",{className:"px-6 py-4 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"w-6 h-6 bg-slate-200 rounded-full"}),(0,b.jsx)("div",{className:"h-6 bg-slate-200 rounded w-40"})]}),(0,b.jsx)("div",{className:"h-6 bg-slate-200 rounded-full w-20"})]}),(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"h-8 bg-slate-200 rounded w-48"}),(0,b.jsx)("div",{className:"h-4 bg-slate-200 rounded w-32"})]}),(0,b.jsxs)("div",{className:"text-right space-y-2",children:[(0,b.jsx)("div",{className:"h-8 bg-slate-200 rounded w-24 ml-auto"}),(0,b.jsx)("div",{className:"h-3 bg-slate-200 rounded w-10 ml-auto"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-6 border-t border-slate-100",children:[(0,b.jsx)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 h-24"}),(0,b.jsx)("div",{className:"p-4 bg-slate-50 rounded-xl border border-slate-100 h-24"})]})]}),(0,b.jsxs)("div",{className:"px-6 py-4 bg-slate-50/50 border-t border-slate-100 flex items-center justify-between",children:[(0,b.jsx)("div",{className:"h-5 bg-slate-200 rounded w-32"}),(0,b.jsx)("div",{className:"h-5 bg-slate-200 rounded w-40"})]})]}):(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-8 text-center",children:[(0,b.jsx)("h2",{className:"font-black text-slate-800 text-xl mb-2",children:"Aucun abonnement actif"}),(0,b.jsx)("p",{className:"text-slate-500 mb-6",children:"Souscrivez Ã  nos alertes mÃ©tÃ©o pour rester informÃ©"}),(0,b.jsx)("a",{href:"/alertes",className:"inline-block px-6 py-3 bg-slate-800 text-white font-bold rounded-xl hover:bg-slate-900 transition-colors",children:"Voir les offres"})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[("admin"===j.role||"super_admin"===j.role)&&(0,b.jsxs)("div",{className:"bg-gradient-to-br from-indigo-600 to-violet-700 rounded-2xl shadow-lg p-6 text-white overflow-hidden relative group",children:[(0,b.jsx)("div",{className:"absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity",children:(0,b.jsx)("svg",{className:"w-24 h-24",fill:"currentColor",viewBox:"0 0 24 24",children:(0,b.jsx)("path",{d:"M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"})})}),(0,b.jsx)("h3",{className:"font-black text-xl mb-2 relative z-10",children:"Espace Admin"}),(0,b.jsx)("p",{className:"text-indigo-100 text-sm mb-4 relative z-10",children:"GÃ©rez les utilisateurs, modÃ©rez les observations et consultez les statistiques."}),(0,b.jsx)(e.default,{href:"/admin",className:"block w-full text-center py-2.5 bg-white text-indigo-600 font-bold rounded-xl hover:bg-indigo-50 transition-colors shadow-sm relative z-10",children:"AccÃ©der au Dashboard"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,b.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-slate-700 to-slate-900 rounded-xl flex items-center justify-center text-white font-black text-xl shadow-md",children:D.charAt(0).toUpperCase()}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-slate-800",children:j.reference}),(0,b.jsx)("p",{className:"text-sm text-slate-500",children:F})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("button",{onClick:()=>A(!0),className:"w-full flex items-center gap-3 px-4 py-3 bg-slate-50 hover:bg-slate-100 text-slate-700 rounded-xl transition-colors text-sm font-medium group",children:[(0,b.jsx)(m,{className:"w-5 h-5"}),"Modifier mon profil"]}),(0,b.jsxs)(e.default,{href:"/dashboard/settings",className:"w-full flex items-center gap-3 px-4 py-3 bg-slate-50 hover:bg-slate-100 text-slate-700 rounded-xl transition-colors text-sm font-medium group",children:[(0,b.jsx)(r,{className:"w-5 h-5"}),"ParamÃ¨tres"]}),(j.subscription||v)&&(0,b.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-slate-50 rounded-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 text-slate-700 text-sm font-medium",children:[(0,b.jsx)(o,{className:"w-5 h-5"}),"Notifications"]}),(0,b.jsx)("button",{onClick:async()=>{let a=!j.notifications_enabled;l(b=>b?{...b,notifications_enabled:a}:null);try{if(!(await fetch("/api/user/notifications",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:a})})).ok)throw Error("Failed");let b=await fetch("/api/auth/me");if(b.ok){let a=await b.json();l(a)}}catch(b){l(b=>b?{...b,notifications_enabled:!a}:null),i("Erreur lors de la mise Ã  jour","error")}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 ${j.notifications_enabled?"bg-emerald-500":"bg-slate-200"}`,children:(0,b.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${j.notifications_enabled?"translate-x-6":"translate-x-1"}`})})]}),(0,b.jsxs)(e.default,{href:"/contact",className:"w-full flex items-center gap-3 px-4 py-3 bg-slate-50 hover:bg-slate-100 text-slate-700 rounded-xl transition-colors text-sm font-medium group",children:[(0,b.jsx)(n,{className:"w-5 h-5"}),"Support client"]})]})]})]})]})]}),(0,b.jsx)(g.Footer,{}),j&&(0,b.jsx)(k,{isOpen:z,onClose:()=>A(!1),user:j})]})}a.s(["DashboardClient",()=>t],72387)}];

//# sourceMappingURL=design-update_TypeScript_weather10_components_dashboard-client_tsx_fe1f3371._.js.map