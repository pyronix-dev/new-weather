module.exports=[26084,(a,b,c)=>{"use strict";b.exports=a.r(16511).vendored.contexts.HooksClientContext},5,(a,b,c)=>{"use strict";b.exports=a.r(16511).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},57945,(a,b,c)=>{"use strict";b.exports=a.r(16511).vendored.contexts.AppRouterContext},1212,(a,b,c)=>{"use strict";b.exports=a.r(16511).vendored["react-ssr"].ReactServerDOMTurbopackClient},65244,a=>{"use strict";var b=a.i(16552),c=a.i(8284),d=a.i(70230),e=a.i(18988),f=a.i(59389),g=a.i(39700),h=a.i(50958);let i=a=>fetch(a).then(a=>a.json());function j({params:a,initialUser:j}){let{id:k}=(0,c.use)(a),{data:l,isLoading:m,mutate:n}=(0,e.default)(`/api/admin/users/${k}`,i),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)({}),{showToast:u}=(0,g.useToast)(),{confirm:v}=(0,h.useConfirm)(),w=async()=>{r(!0);try{await fetch(`/api/admin/users/${k}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),await n(),p(!1),u("Modifications enregistrées","success")}catch(a){u("Erreur lors de la sauvegarde","error")}finally{r(!1)}},x=async(a,b)=>{try{let c=await fetch("/api/admin/subscriptions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:k,action:a,durationDays:b})}),d=await c.json();if(!c.ok)throw Error(d.error);await n(),u("Action effectuée avec succès","success")}catch(a){u(a.message||"Erreur lors de l'action","error")}},y=async()=>{let a=await v({title:"Ajouter un abonnement",message:"Entrez la durée en jours",inputPlaceholder:"30",inputDefaultValue:"30",confirmText:"Ajouter",variant:"info"});if(!a)return;let b=parseInt("string"==typeof a?a:"30");if(isNaN(b))return u("Durée invalide","error");x("grant",b)},z=async()=>{let a=await v({title:"Prolonger l'abonnement",message:"Entrez la durée en jours supplémentaire",inputPlaceholder:"30",inputDefaultValue:"30",confirmText:"Prolonger",variant:"info"});if(!a)return;let b=parseInt("string"==typeof a?a:"30");if(isNaN(b))return u("Durée invalide","error");x("extend",b)},A=async()=>{await v({title:"Annuler l'abonnement ?",message:"L'utilisateur perdra son accès premium immédiatement.",confirmText:"Annuler l'abonnement",variant:"danger"})&&x("cancel")};if(m)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:(0,b.jsx)("div",{className:"w-8 h-8 border-2 border-slate-300 border-t-slate-600 rounded-full animate-spin"})});if(!l?.user)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-slate-50",children:(0,b.jsxs)("div",{className:"text-center p-8 bg-white rounded-2xl shadow-lg",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-red-600 mb-2",children:"Utilisateur non trouvé"}),(0,b.jsx)(d.default,{href:"/admin",className:"text-blue-600 hover:underline",children:"Retour"})]})});let B=l.user;return(0,b.jsxs)("div",{className:"min-h-screen bg-slate-50",children:[(0,b.jsx)(f.Header,{initialUser:j}),(0,b.jsxs)("main",{className:"max-w-4xl mx-auto px-4 py-8",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,b.jsx)(d.default,{href:"/admin",className:"text-slate-500 hover:text-slate-700",children:"← Retour"}),(0,b.jsx)("h1",{className:"text-2xl font-black text-slate-800",children:"Détails Utilisateur"})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-slate-800",children:B.full_name||"Sans nom"}),(0,b.jsx)("p",{className:"text-slate-500 font-mono",children:B.reference_code})]}),(0,b.jsx)("div",{className:"flex gap-2",children:o?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{onClick:w,disabled:q,className:"px-4 py-2 bg-green-500 text-white rounded-lg text-sm font-medium hover:bg-green-600 disabled:opacity-50",children:q?"Sauvegarde...":"Sauvegarder"}),(0,b.jsx)("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-slate-200 text-slate-700 rounded-lg text-sm font-medium hover:bg-slate-300",children:"Annuler"})]}):(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("button",{onClick:()=>{t({full_name:l?.user.full_name,email:l?.user.email,phone:l?.user.phone,is_banned:l?.user.is_banned,banned_reason:l?.user.banned_reason}),p(!0)},className:"px-4 py-2 bg-blue-500 text-white rounded-lg text-sm font-medium hover:bg-blue-600",children:"Modifier"})})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Email"}),o?(0,b.jsx)("input",{type:"email",value:s.email||"",onChange:a=>t({...s,email:a.target.value}),className:"w-full mt-1 px-3 py-2 border border-slate-200 rounded-lg"}):(0,b.jsx)("p",{className:"text-slate-800",children:B.email||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Téléphone"}),o?(0,b.jsx)("input",{type:"tel",value:s.phone||"",onChange:a=>t({...s,phone:a.target.value}),className:"w-full mt-1 px-3 py-2 border border-slate-200 rounded-lg"}):(0,b.jsx)("p",{className:"text-slate-800",children:B.phone||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Nom Complet"}),o?(0,b.jsx)("input",{type:"text",value:s.full_name||"",onChange:a=>t({...s,full_name:a.target.value}),className:"w-full mt-1 px-3 py-2 border border-slate-200 rounded-lg"}):(0,b.jsx)("p",{className:"text-slate-800",children:B.full_name||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Rôle"}),(0,b.jsx)("p",{className:"text-slate-800 capitalize",children:B.role})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Créé le"}),(0,b.jsx)("p",{className:"text-slate-800",children:new Date(B.created_at).toLocaleString("fr-FR")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-xs font-bold text-slate-500 uppercase",children:"Statut"}),(0,b.jsxs)("div",{className:"flex gap-2 mt-1",children:[B.is_banned&&(0,b.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs font-bold rounded-full",children:"Banni"}),B.is_verified&&(0,b.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-700 text-xs font-bold rounded-full",children:"Vérifié"})]})]})]}),B.is_banned&&B.banned_reason&&(0,b.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs font-bold text-red-600 uppercase mb-1",children:"Raison du bannissement"}),(0,b.jsx)("p",{className:"text-red-700",children:B.banned_reason})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-6",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-800 mb-4",children:"Historique de Connexion"}),0===l.loginHistory.length?(0,b.jsx)("p",{className:"text-slate-500",children:"Aucun historique disponible"}):(0,b.jsx)("div",{className:"space-y-3",children:l.loginHistory.map(a=>(0,b.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-mono text-sm text-slate-800",children:a.ip_address||"IP inconnue"}),(0,b.jsxs)("p",{className:"text-xs text-slate-500",children:[a.location_city,", ",a.location_country," • ",a.isp]})]}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:new Date(a.created_at).toLocaleString("fr-FR")})]},a.id))})]}),(0,b.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-slate-200 p-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-800",children:"Abonnements"}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsx)("button",{onClick:y,className:"px-3 py-1.5 bg-indigo-50 text-indigo-700 text-xs font-bold rounded-lg hover:bg-indigo-100",children:"+ Ajouter"})})]}),0===l.subscriptions.length?(0,b.jsx)("p",{className:"text-slate-500",children:"Aucun abonnement"}):(0,b.jsx)("div",{className:"space-y-3",children:l.subscriptions.map(a=>(0,b.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg flex items-center justify-between group",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:a.plan}),(0,b.jsxs)("p",{className:"text-xs text-slate-500",children:[(a.amount/100).toFixed(2),"€ • Expire: ",a.expires_at?new Date(a.expires_at).toLocaleDateString("fr-FR"):"N/A"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("span",{className:`px-2 py-1 text-xs font-bold rounded-full ${"active"===a.status?"bg-green-100 text-green-700":"bg-slate-200 text-slate-600"}`,children:a.status}),"active"===a.status&&(0,b.jsxs)("div",{className:"flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,b.jsx)("button",{onClick:z,className:"p-1 hover:bg-slate-200 rounded",title:"Prolonger",children:"➕"}),(0,b.jsx)("button",{onClick:A,className:"p-1 hover:bg-red-100 rounded text-red-600",title:"Annuler",children:"✖️"})]})]})]},a.id))})]})]})]})}a.s(["default",()=>j])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__4fa1fbd2._.js.map